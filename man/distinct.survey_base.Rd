% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/distinct.R
\name{distinct.survey_base}
\alias{distinct.survey_base}
\title{Remove duplicate rows from a survey design object}
\usage{
distinct.survey_base(.data, ..., .keep_all = FALSE)
}
\arguments{
\item{.data}{A \code{\link[surveycore:survey_base]{survey_base}} object.}

\item{...}{<\code{\link[rlang:args_data_masking]{data-masking}}> Optional columns
used to determine uniqueness. If empty, all non-design columns are used.
Note: \code{.keep_all} is always \code{TRUE} regardless of what is specified here.}

\item{.keep_all}{Accepted for interface compatibility; \strong{has no effect}.
The survey implementation always retains all columns in \verb{@data}.}
}
\value{
An object of the same class as \code{.data} with the following properties:
\itemize{
\item Rows physically reduced to distinct subset (fewer rows possible).
\item All columns in \verb{@data} are retained (\code{.keep_all = TRUE} always).
\item \verb{@variables$visible_vars} is unchanged — distinct is a pure row operation.
\item \verb{@metadata} is unchanged.
\item \verb{@groups} is unchanged.
\item Always issues \code{surveycore_warning_physical_subset}.
}
}
\description{
\code{distinct()} \strong{physically removes duplicate rows} from a survey design
object, always issuing \code{surveycore_warning_physical_subset}. Unlike
\code{\link[dplyr:distinct]{dplyr::distinct()}}, all columns in \verb{@data} are retained regardless of
which columns are specified in \code{...} — design variables must never be
lost from the survey object.

For subpopulation analyses, use \code{\link[=filter]{filter()}} instead — it marks rows
out-of-domain without removing them, preserving valid variance estimation.
}
\details{
\subsection{Column retention}{

\code{distinct()} always behaves as if \code{.keep_all = TRUE}. Specifying columns
in \code{...} controls which columns determine uniqueness — it does \strong{not}
control which columns appear in the result. This is a deliberate
divergence from \code{dplyr::distinct(df, x, y)} which by default drops all
columns except \code{x} and \code{y}.
}

\subsection{Default deduplication (empty \code{...})}{

When \code{...} is empty, deduplication uses all non-design columns. Design
variables (strata, PSU, weights, FPC) are excluded from the uniqueness
check — deduplicating on them would produce meaningless or
survey-corrupting results.
}

\subsection{Design variable warning}{

If \code{...} includes a design variable, \code{surveytidy_warning_distinct_design_var}
is issued before the operation. The operation still proceeds after the
warning — the user is assumed to know what they are doing.
}
}
\examples{
library(surveytidy)
library(dplyr)
library(surveycore)
d <- as_survey(pew_npors_2025, weights = weight, strata = stratum)

# Deduplicate on all non-design columns (issues physical-subset warning)
distinct(d)

# Deduplicate by one column (all other columns still retained)
distinct(d, cregion)

}
\seealso{
\code{\link[=filter]{filter()}} for domain-aware row marking (preferred for
subpopulation analyses)

Other row operations: 
\code{\link{drop_na.survey_base}()},
\code{\link{slice.survey_base}()}
}
\concept{row operations}
